(function(e){function t(t){for(var i,o,a=t[0],u=t[1],c=t[2],m=0,h=[];m<a.length;m++)o=a[m],n[o]&&h.push(n[o][0]),n[o]=0;for(i in u)Object.prototype.hasOwnProperty.call(u,i)&&(e[i]=u[i]);l&&l(t);while(h.length)h.shift()();return s.push.apply(s,c||[]),r()}function r(){for(var e,t=0;t<s.length;t++){for(var r=s[t],i=!0,a=1;a<r.length;a++){var u=r[a];0!==n[u]&&(i=!1)}i&&(s.splice(t--,1),e=o(o.s=r[0]))}return e}var i={},n={app:0},s=[];function o(t){if(i[t])return i[t].exports;var r=i[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=i,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)o.d(r,i,function(t){return e[t]}.bind(null,i));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],u=a.push.bind(a);a.push=t,a=a.slice();for(var c=0;c<a.length;c++)t(a[c]);var l=u;s.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"034f":function(e,t,r){"use strict";var i=r("64a9"),n=r.n(i);n.a},"1e92":function(e,t,r){"use strict";var i=r("3ba5"),n=r.n(i);n.a},"3ba5":function(e,t,r){},"56d7":function(e,t,r){"use strict";r.r(t);r("cadf"),r("551c"),r("f751"),r("097d");var i=r("2b0e"),n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app"}},[r("Timer")],1)},s=[],o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("vue-headful",{attrs:{title:e._f("timer")(e.timeLeft)}}),r("fullscreen",{ref:"fullscreen",on:{change:e.fullscreenChange}},[e._l(e.bellPoints,function(t){return r("div",{staticClass:"bellline",style:{width:t/e.timerLength*100+"%"}})}),r("div",{attrs:{id:"prg"}},[r("div",{class:{final:e.isFinal},style:{width:e.currentPercentage+"%"},attrs:{id:"bar"}}),r("div",{style:{width:e.percentage+"%"},attrs:{id:"totalbar"}})]),r("div",{attrs:{id:"timer"},on:{click:e.pressSpace}},[r("span",{directives:[{name:"resize-text",rawName:"v-resize-text",value:{ratio:1},expression:"{ratio:1}"}],staticClass:"timeleft",class:{label:e.currentLabel}},[e._v(e._s(e._f("timer")(e.currentTimeLeft,e.currentLabel)))])]),r("a",{directives:[{name:"shortkey",rawName:"v-shortkey",value:["f"],expression:"['f']"}],attrs:{id:"fullscreen"},on:{shortkey:function(t){return e.toggleFS()},click:e.toggleFS}},[r("img",{attrs:{src:"/images/fullscreen.png"}})]),r("div",{attrs:{id:"controls"}},[r("a",{directives:[{name:"shortkey",rawName:"v-shortkey.once",value:["h"],expression:"['h']",modifiers:{once:!0}}],on:{shortkey:function(t){return e.showHelp()},click:e.showHelp}},[r("img",{attrs:{src:"/images/help.png"}})]),r("a",{directives:[{name:"shortkey",rawName:"v-shortkey.once",value:["s"],expression:"['s']",modifiers:{once:!0}}],on:{shortkey:function(t){return e.setTime()},click:e.setTime}},[r("img",{attrs:{src:"/images/alarm.png"}})]),r("i",{directives:[{name:"shortkey",rawName:"v-shortkey.once",value:["space"],expression:"['space']",modifiers:{once:!0}}],on:{shortkey:function(t){return e.toggleTicker()}}}),r("i",{directives:[{name:"shortkey",rawName:"v-shortkey.once",value:["1"],expression:"['1']",modifiers:{once:!0}}],on:{shortkey:function(t){return e.moreTime(60)}}}),r("i",{directives:[{name:"shortkey",rawName:"v-shortkey.once",value:["2"],expression:"['2']",modifiers:{once:!0}}],on:{shortkey:function(t){return e.moreTime(120)}}}),r("i",{directives:[{name:"shortkey",rawName:"v-shortkey.once",value:["3"],expression:"['3']",modifiers:{once:!0}}],on:{shortkey:function(t){return e.moreTime(180)}}}),r("i",{directives:[{name:"shortkey",rawName:"v-shortkey.once",value:["4"],expression:"['4']",modifiers:{once:!0}}],on:{shortkey:function(t){return e.moreTime(240)}}}),r("i",{directives:[{name:"shortkey",rawName:"v-shortkey.once",value:["5"],expression:"['5']",modifiers:{once:!0}}],on:{shortkey:function(t){return e.moreTime(300)}}}),r("i",{directives:[{name:"shortkey",rawName:"v-shortkey.once",value:["6"],expression:"['6']",modifiers:{once:!0}}],on:{shortkey:function(t){return e.moreTime(360)}}}),r("i",{directives:[{name:"shortkey",rawName:"v-shortkey.once",value:["7"],expression:"['7']",modifiers:{once:!0}}],on:{shortkey:function(t){return e.moreTime(420)}}}),r("i",{directives:[{name:"shortkey",rawName:"v-shortkey.once",value:["8"],expression:"['8']",modifiers:{once:!0}}],on:{shortkey:function(t){return e.moreTime(480)}}}),r("i",{directives:[{name:"shortkey",rawName:"v-shortkey.once",value:["9"],expression:"['9']",modifiers:{once:!0}}],on:{shortkey:function(t){return e.moreTime(520)}}}),r("i",{directives:[{name:"shortkey",rawName:"v-shortkey.once",value:["0"],expression:"['0']",modifiers:{once:!0}}],on:{shortkey:function(t){return e.moreTime(600)}}}),r("i",{directives:[{name:"shortkey",rawName:"v-shortkey.once",value:["r"],expression:"['r']",modifiers:{once:!0}}],on:{shortkey:function(t){return e.restart()}}}),r("i",{directives:[{name:"shortkey",rawName:"v-shortkey.once",value:["s"],expression:"['s']",modifiers:{once:!0}}],on:{shortkey:function(t){return e.setTime()}}}),r("i",{directives:[{name:"shortkey",rawName:"v-shortkey.once",value:["esc"],expression:"['esc']",modifiers:{once:!0}}],on:{shortkey:function(t){return e.setTime()}}}),r("i",{directives:[{name:"shortkey",rawName:"v-shortkey.once",value:["t"],expression:"['t']",modifiers:{once:!0}}],on:{shortkey:function(t){return e.moreTime(10)}}})]),r("div",{attrs:{id:"footer"}},[r("strong",[e._v("Press H")]),e._v(" for help. Made for facilitators by "),r("a",{attrs:{href:"http://source.institute"}},[r("img",{staticClass:"logo",attrs:{src:"/images/logo.png"}})])]),r("modal",{attrs:{name:"set",height:"auto",pivotY:.2,adaptive:!0},on:{"before-close":function(e){}}},[r("form",{on:{submit:function(t){return t.preventDefault(),e.setClosed(t)}}},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.requestedTime,expression:"requestedTime"},{name:"focus",rawName:"v-focus"},{name:"shortkey",rawName:"v-shortkey.avoid",modifiers:{avoid:!0}}],attrs:{id:"time",placeholder:"Type seconds or HH:MM:SS",autocomplete:"off"},domProps:{value:e.requestedTime},on:{focus:function(e){return e.target.select()},input:function(t){t.target.composing||(e.requestedTime=t.target.value)}}}),r("p",[e._v("Then press "),r("strong",[e._v("enter")]),e._v(". You can set the timer any time by pressing "),r("strong",[e._v("Esc")]),e._v(" or "),r("strong",[e._v("S")]),e._v(".")])])]),r("modal",{attrs:{name:"help",height:"auto",width:"80%",adaptive:!0,scrollable:!0}},[r("div",{attrs:{id:"help"}},[r("h3",[e._v("Help")]),r("p",[e._v("This is a new project so "),r("a",{attrs:{href:"mailto:salim@source.institute"}},[e._v("feedback welcome!")])]),r("p",[e._v("Set the time by pressing "),r("strong",[e._v("S")]),e._v(" or "),r("strong",[e._v("Esc")]),e._v(".")]),r("p",[e._v("Press "),r("strong",[e._v("space")]),e._v(" to pause/unpause. "),r("strong",[e._v("R")]),e._v(" restarts the time. "),r("strong",[e._v("F")]),e._v(" toggles fullscreen.")]),r("p",[e._v("While the timer's running, "),r("strong",[e._v("1-9")]),e._v(" adds bonus time (in minutes). "),r("strong",[e._v("0")]),e._v(" adds 10 minutes. "),r("strong",[e._v("T")]),e._v(" adds 10 seconds."),r("br")]),r("p",[e._v("Autostart by adding the timer to the address.  For example, "),r("strong",[r("a",{attrs:{href:"http://sourcetimer.com/3:00"}},[e._v("sourcetimer.com/3:00")])]),e._v(" for 3 minutes.")]),r("p",[e._v("You can chain timers with "),r("strong",[e._v("/")]),e._v(" like "),r("strong",[e._v("10/2:30/30")]),e._v(" to run a 10 second, 2 and half minute, then 30 second timer. And you can add instructions with "),r("strong",[e._v("()")]),e._v(" like "),r("strong",[e._v("10(Get ready)/2:30(Work)/30(Clean up)")]),e._v(". This is great for setting up links from your presentations.")])])])],2)],1)},a=[],u=r("e814"),c=r.n(u),l=(r("a481"),r("4917"),r("6762"),r("2fdb"),r("28a5"),r("c5f6"),r("0a0d")),m=r.n(l),h={name:"Timer",props:{},components:{},data:function(){return{startTS:m()(),timerLength:60,timeLeft:60,timeElapsed:0,currentTimeLeft:60,currentLabel:"",timeElapsedSaved:0,autostart:!1,running:!1,stopped:!1,fullscreen:!1,bellPoints:new Array,internalTimers:new Array,internalTimerLabels:new Array,internalTimerMarker:0,nextBell:new Array,requestedTime:decodeURI(window.location.pathname.slice(1)),currentRequest:null,isFinal:!1}},watch:{requestedTime:function(){this.setupBellPoints(),this.startTS=m()()-1,this.updateTimeLeft({force:!0}),this.stopTicker()},internalTimerLabels:function(){this.updateCurrentLabel()},internalTimerMarker:function(){this.updateCurrentLabel()}},directives:{focus:{inserted:function(e){e.focus()}}},computed:{endTS:function(){return this.startTS+1e3*this.timerLength},currentTimerLength:function(){var e=this.timerLength;return"undefined"!==typeof this.internalTimers[this.internalTimerMarker]&&(e=this.internalTimers[this.internalTimerMarker]),e},percentage:function(){return(Number(this.timerLength-this.timeLeft)/Number(this.timerLength)*100).toFixed(2)},currentPercentage:function(){return(Number(this.timerLength-this.timeLeft-this.prevTimers)/this.currentTimerLength*100).toFixed(2)},prevTimers:function(){var e=0;return"undefined"!==typeof this.bellPoints[this.internalTimerMarker-1]&&(e=this.bellPoints[this.internalTimerMarker-1]),e},upcomingBell:function(){return"undefined"!==typeof this.nextBell[0]?this.nextBell[0]:this.timerLength}},methods:{setupTicker:function(){var e=this;this.timer=setInterval(function(){return e.updateTimeLeft()},500),this.running=!0,this.$matomo.trackEvent("timer","start")},moreTime:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:60;if(this.running){this.timerLength+=e,this.internalTimers[this.internalTimerMarker]+=e;for(var t=0;t<this.bellPoints.length;t++)this.internalTimers[t]>this.timeElapsed&&(this.bellPoints[t]+=e);for(t=0;t<this.nextBell.length;t++)this.nextBell[t]+=e;this.$matomo.trackEvent("timer","moretime")}},nextInternalTimer:function(){this.nextBell.shift(),this.internalTimerMarker++,this.updateTimeLeft()},updateCurrentLabel:function(){var e=this.internalTimerLabels[this.internalTimerMarker];"undefined"===typeof e&&(this.currentLabel=""),this.currentLabel=e},updateTimeLeft:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.running||1==e["force"]){this.timeLeft=(this.endTS-m()())/1e3,this.timeElapsed=this.timerLength-this.timeLeft;this.internalTimers.reduce(function(e,t){return e+t},0);if(this.currentTimeLeft=Math.max(0,this.prevTimers-this.timeElapsed+this.currentTimerLength),this.timeLeft<Math.min(this.timerLength/5,60)?this.isFinal=!0:this.isFinal=!1,this.timerLength-this.timeLeft>this.upcomingBell){var t=new Audio("/sounds/bell.mp3");t.play(),this.nextInternalTimer()}if(this.timeLeft<0){this.isFinal=!1;t=new Audio("/sounds/bell.mp3");t.play(),this.futureTimers?(this.queueNextTimers(),this.restart()):(this.running=!1,this.stopped=!0,this.setTime())}}},setTime:function(){this.stopTicker(),this.$modal.show("set"),this.$matomo.trackEvent("timer","set")},setClosed:function(){this.restart(),this.$modal.hide("set")},setupBellPoints:function(){var e=this.requestedTime,t=0;if(e){var r=e.split("/");if(e.includes("/")){for(var i=0;i<r.length;i++)this.internalTimerLabels[i]=this.convertClockToLabel(r[i]),this.internalTimers[i]=this.convertClockToSeconds(r[i]),t+=this.internalTimers[i],this.bellPoints[i]=t;this.internalTimerMarker=0,this.bellPoints.pop(),this.nextBell=this.bellPoints.slice()}else t=e;this.timerLength=t,this.timeLeft=t}},queueNextTimers:function(){this.setupFutureTimers()},convertClockToLabel:function(e){return!!e&&((e=e.match(/\(([^)]+)\)/))?e[1]:"")},convertClockToSeconds:function(e){if(!e)return!1;var t,r,i;if(e=e.replace(/\(([^)]+)\)/gi,""),e=e.replace(/[^[0-9:]/gi,""),e.includes(":")){this.autostart=!0,t=e.split(":"),r=0,i=1;while(t.length>0)r+=Number(i)*c()(Number(t.pop()),10),i*=60}else r=Number(e);return r},convertRequestToTimers:function(){this.timerLength=this.convertClockToSeconds(this.currentRequest)},toggleFS:function(){this.$matomo.trackEvent("timer","fs"),this.$fullscreen.toggle(document.body,{background:"#fff"})},stopTicker:function(){this.running=!1,this.timeElapsedSaved=this.timerLength-this.timeLeft,this.$matomo.trackEvent("timer","pause")},startTicker:function(){this.running=!0,this.startTS=m()()-1e3*this.timeElapsedSaved,this.$matomo.trackEvent("timer","unpause")},pressSpace:function(){"0:00"==this.timeLeft?this.setTime():this.toggleTicker()},toggleTicker:function(){this.running?this.stopTicker():this.startTicker()},fullscreenChange:function(e){this.fullscreen=e},restart:function(){this.startTS=m()(),this.setupBellPoints(),this.running=!0,this.$matomo.trackEvent("timer","restart")},showHelp:function(){this.$modal.toggle("help"),this.$matomo.trackEvent("timer","help")}},filters:{timer:function(e,t){if(t)return t;if(isNaN(e))return e;e+=1;var r,i=c()(e,10),n=Math.floor(i/3600),s=Math.floor((i-3600*n)/60),o=i-3600*n-60*s;return s<10&&n>0&&(s="0"+s),o<10&&(o="0"+o),r=o,r=s+":"+r,n>0&&(r=n+":"+r),r}},beforeMount:function(){this.setupTicker(),this.setupBellPoints(),this.updateCurrentLabel(),this.updateTimeLeft()},mounted:function(){""==this.requestedTime&&this.$modal.show("set")},beforeDestroy:function(){clearInterval(this.timer)}},f=h,d=(r("1e92"),r("2877")),v=Object(d["a"])(f,o,a,!1,null,null,null),p=v.exports,g={name:"app",components:{Timer:p}},k=g,T=(r("034f"),Object(d["a"])(k,n,s,!1,null,null,null)),y=T.exports,b=r("ec02"),_=r.n(b),w=r("03cd"),L=r.n(w),x=r("1881"),N=r.n(x),S=r("12d0"),P=r.n(S),M=r("d3a2"),E=r.n(M);i["a"].use(L.a,{name:"fullscreen"}),i["a"].use(r("3717"),{prevent:["input","textarea"]}),i["a"].use(N.a),i["a"].use(P.a,{host:"http://piwik.source.institute",siteId:8,enableLinkTracking:!0}),i["a"].use(E.a),i["a"].config.productionTip=!1,i["a"].component("vue-headful",_.a),new i["a"]({render:function(e){return e(y)}}).$mount("#app")},"64a9":function(e,t,r){}});
//# sourceMappingURL=app.bf312ab9.js.map